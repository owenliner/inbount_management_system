# 系统架构概述

## 1. 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                        Client Layer                          │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                   React Frontend                      │    │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────┐  │    │
│  │  │   Ant    │ │  React   │ │ Zustand  │ │Recharts│  │    │
│  │  │  Design  │ │  Query   │ │  Store   │ │ Charts │  │    │
│  │  └──────────┘ └──────────┘ └──────────┘ └────────┘  │    │
│  └─────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ HTTP/REST
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        API Layer                             │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                   FastAPI Backend                     │    │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌────────┐  │    │
│  │  │   Auth   │ │   API    │ │ Services │ │ Models │  │    │
│  │  │   JWT    │ │  Routes  │ │  Layer   │ │  ORM   │  │    │
│  │  └──────────┘ └──────────┘ └──────────┘ └────────┘  │    │
│  └─────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ SQL/TCP
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                       Data Layer                             │
│  ┌──────────────────────┐  ┌──────────────────────┐        │
│  │      PostgreSQL      │  │        Redis          │        │
│  │    (Primary Data)    │  │   (Session Cache)     │        │
│  └──────────────────────┘  └──────────────────────┘        │
└─────────────────────────────────────────────────────────────┘
```

## 2. 技术选型说明

### 2.1 后端技术栈

| 技术 | 用途 | 选择理由 |
|------|------|----------|
| FastAPI | Web 框架 | 高性能、自动文档、类型提示 |
| SQLAlchemy | ORM | 成熟稳定、功能强大 |
| Alembic | 数据库迁移 | SQLAlchemy 原生支持 |
| PostgreSQL | 主数据库 | 可靠、功能丰富 |
| Redis | 缓存 | 高性能、会话存储 |
| Pydantic | 数据验证 | 类型安全、自动序列化 |
| python-jose | JWT | 标准实现、安全可靠 |

### 2.2 前端技术栈

| 技术 | 用途 | 选择理由 |
|------|------|----------|
| React 18 | UI 框架 | 生态丰富、性能优秀 |
| TypeScript | 类型系统 | 代码质量、开发体验 |
| Vite | 构建工具 | 快速、现代 |
| Ant Design 5 | UI 组件 | 企业级、中文友好 |
| Zustand | 状态管理 | 轻量、简洁 |
| React Query | 数据获取 | 缓存、自动刷新 |
| Recharts | 图表 | React 原生、易用 |
| Tailwind CSS | 样式 | 实用优先、快速开发 |

## 3. 模块设计

### 3.1 后端模块

```
backend/app/
├── api/v1/           # API 路由层
│   ├── auth.py       # 认证相关
│   ├── users.py      # 用户管理
│   ├── warehouses.py # 仓库管理
│   ├── stock.py      # 库存管理
│   ├── inbound.py    # 入库管理
│   └── dashboard.py  # 仪表盘
├── models/           # 数据模型层
│   ├── user.py       # 用户相关模型
│   ├── warehouse.py  # 仓库相关模型
│   └── stock.py      # 库存相关模型
├── schemas/          # 数据验证层
│   └── ...           # Pydantic 模式
├── services/         # 业务逻辑层
│   └── ...           # 服务类
└── core/             # 核心模块
    └── security.py   # 安全认证
```

### 3.2 前端模块

```
frontend/src/
├── api/              # API 客户端
│   ├── client.ts     # Axios 配置
│   └── *.ts          # 各模块 API
├── components/       # 通用组件
│   └── Layout/       # 布局组件
├── pages/            # 页面组件
│   ├── Login.tsx     # 登录页
│   ├── Dashboard.tsx # 仪表盘
│   └── */            # 各功能模块
├── store/            # 状态管理
│   └── authStore.ts  # 认证状态
└── routes/           # 路由配置
```

## 4. 数据流

```
用户操作 → React 组件 → API 调用 → FastAPI 路由 → 服务层 → 数据库
    ↑                                                        │
    └────────────────── 响应数据 ──────────────────────────────┘
```

## 5. 安全设计

- **JWT 认证**: 无状态令牌认证
- **密码加密**: bcrypt 哈希存储
- **CORS**: 跨域资源共享配置
- **输入验证**: Pydantic 模式验证
- **SQL 注入防护**: ORM 参数化查询
